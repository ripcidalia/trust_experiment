/* ==========================================================================
   scene.css
   Purpose: Visual layout for the interactive scene (background, doors,
            drone layering) and lightweight HUD (trial counter).
   Notes:
   - Scene fills the visible viewport (accounts for mobile safe areas).
   - Z-index layering (low→high): background (0) → revealed image (1)
     → doors/overlays (2) → cone (3, defined elsewhere) → drone (4)
     → HUD/missions (higher, defined elsewhere).
   ========================================================================== */

/* ===== 1) Root scene & frame =================================================
   Fill the visible viewport and center the content while respecting safe areas.
   -------------------------------------------------------------------------- */
.scene-root {
  display: flex;
  justify-content: center;
  align-items: center;

  width: 100vw;
  height: 100svh; /* fallback for older Safari */
  height: 100dvh; /* preferred visible viewport height */

  margin: 0;
  padding-top: var(--safe-top);
  padding-bottom: var(--safe-bottom);

  background: #000;
  overflow: hidden;
}

.scene-frame {
  position: relative;
  width: 100vw;
  max-width: 100vw;
  line-height: 0; /* remove inline-img gaps */
  overflow: visible;
}

/* Background image sits at the very back. */
.background {
  width: 100%;
  height: auto;
  display: block;
  user-select: none;
  -webkit-user-drag: none;
  z-index: 0;
}

/* ===== 2) Door overlays & reveal images =====================================
   Doors are tappable/clickable; internal assets remain non-interactive.
   -------------------------------------------------------------------------- */
.overlay {
  position: absolute;
  z-index: 2;
  overflow: visible;
  pointer-events: auto; /* doors receive input */
}

.overlay .door-image {
  width: 100%;
  height: 100%;
  display: block;
  object-fit: contain;
  user-select: none;
  -webkit-user-drag: none;

  transform-origin: left center; /* hinge from the left edge */
  transition: transform 0.55s cubic-bezier(.2, .9, .1, 1);

  pointer-events: none; /* clicks go to overlay, not the img */
}

/* Applied by JS to animate a horizontal “open” (hinge) effect. */
.door-open {
  transform: scaleX(0);
}

/* Victim/empty image revealed behind the door. */
.revealed-image {
  position: absolute;
  z-index: 1; /* below doors (2), above background (0) */
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: block;
  object-fit: contain;
}

/* ===== 3) HUD: Trial counter =================================================
   Fixed to top-right (beneath Exit button), non-interactive.
   -------------------------------------------------------------------------- */
.trial-counter {
  position: fixed;
  top: calc(var(--safe-top) + 12px + 46px + 6px); /* exit top + button height + gap */
  right: 12px;

  left: auto;
  transform: none;

  z-index: 10011; /* slightly above exit button to avoid occlusion */
  color: #fff;
  font-size: 22px;
  font-weight: 700;
  letter-spacing: .5px;
  text-shadow: 0 2px 6px rgba(0, 0, 0, .6);

  user-select: none;
  -webkit-user-select: none;
  pointer-events: none;

  display: inline-flex;
  align-items: baseline;
  gap: 6px;
}

.trial-counter .tc-label {
  opacity: .9;
  font-weight: 800;
  letter-spacing: .3px;
}

.trial-counter .tc-of {
  opacity: .8;
  font-weight: 600;
}

.trial-counter .tc-index,
.trial-counter .tc-total {
  font-weight: 800;
}
